filter(pathologic_stage %in% c("Stage II", "Stage IV")) %>%
mutate(pathologic_stage = factor(pathologic_stage))
# Create survival object
surv_object <- Surv(time = filtered_data$time_in_years, event = filtered_data$vital_status)
# Fit Kaplan-Meier survival model
fit <- survfit(surv_object ~ pathologic_stage, data = filtered_data)
# Function to compute Mean Residual Life from survfit object
compute_mrl <- function(fit) {
time <- fit$time
surv_probs <- fit$surv
strata <- rep(names(fit$strata), fit$strata)
df <- data.frame(time = time, surv = surv_probs, strata = strata)
mrl_df <- df %>%
group_by(strata) %>%
arrange(time) %>%
mutate(
delta_t = lead(time, default = max(time)) - time,
area = surv * delta_t,
mrl = rev(cumsum(rev(area)))  # Mean Residual Life
)
return(mrl_df)
}
# Compute MRL values
mrl_data <- compute_mrl(fit)
# Plot Mean Residual Life
ggplot(mrl_data, aes(x = time, y = mrl, color = strata)) +
geom_line(size = 1.2) +
labs(
title = "Mean Residual Life: Stage II vs Stage IV",
x = "Time in Years",
y = "Mean Residual Life (Years)",
color = "Pathologic Stage"
) +
theme_minimal()
# Load libraries
library(survival)
library(ggplot2)
library(dplyr)
# Function to compute MRL from survfit
compute_mrl <- function(fit) {
time <- fit$time
surv_probs <- fit$surv
strata <- rep(names(fit$strata), fit$strata)
df <- data.frame(time = time, surv = surv_probs, strata = strata)
mrl_df <- df %>%
group_by(strata) %>%
arrange(time) %>%
mutate(
delta_t = lead(time, default = max(time)) - time,
area = surv * delta_t,
mrl = rev(cumsum(rev(area)))
)
return(mrl_df)
}
# Function to interpolate MRL values on common time grid
interpolate_mrl <- function(mrl_df, group_name, grid_times) {
approx_df <- approx(mrl_df$time, mrl_df$mrl, xout = grid_times, rule = 2)
data.frame(
time = grid_times,
mrl = approx_df$y,
group = group_name
)
}
# Get MRL data for 2 vs 3
data_2_3 <- surv_brca_cli %>%
filter(pathologic_stage %in% c("Stage II", "Stage III")) %>%
mutate(pathologic_stage = factor(pathologic_stage))
fit_2_3 <- survfit(Surv(time_in_years, vital_status) ~ pathologic_stage, data = data_2_3)
mrl_2_3 <- compute_mrl(fit_2_3)
# Get MRL data for 2 vs 4
data_2_4 <- surv_brca_cli %>%
filter(pathologic_stage %in% c("Stage II", "Stage IV")) %>%
mutate(pathologic_stage = factor(pathologic_stage))
fit_2_4 <- survfit(Surv(time_in_years, vital_status) ~ pathologic_stage, data = data_2_4)
mrl_2_4 <- compute_mrl(fit_2_4)
# Create a common time grid
common_times <- sort(unique(c(mrl_2_3$time, mrl_2_4$time)))
common_times <- common_times[common_times > 0]  # Avoid time zero issues
# Interpolate both comparisons on common time grid
mrl_2_3_stage2 <- interpolate_mrl(filter(mrl_2_3, strata == "pathologic_stage=Stage II"), "Stage II", common_times)
mrl_2_3_stage3 <- interpolate_mrl(filter(mrl_2_3, strata == "pathologic_stage=Stage III"), "Stage III", common_times)
mrl_2_4_stage2 <- interpolate_mrl(filter(mrl_2_4, strata == "pathologic_stage=Stage II"), "Stage II", common_times)
mrl_2_4_stage4 <- interpolate_mrl(filter(mrl_2_4, strata == "pathologic_stage=Stage IV"), "Stage IV", common_times)
# Compute MRL differences
mrl_diff_2_3 <- data.frame(
time = common_times,
mrl_diff = mrl_2_3_stage2$mrl - mrl_2_3_stage3$mrl,
comparison = "Stage II - Stage III"
)
mrl_diff_2_4 <- data.frame(
time = common_times,
mrl_diff = mrl_2_4_stage2$mrl - mrl_2_4_stage4$mrl,
comparison = "Stage II - Stage IV"
)
# Combine for plotting
mrl_diff_all <- bind_rows(mrl_diff_2_3, mrl_diff_2_4)
# Plot
ggplot(mrl_diff_all, aes(x = time, y = mrl_diff, color = comparison)) +
geom_line(size = 1.2) +
labs(
title = "Difference in Mean Residual Life",
subtitle = "Stage II vs Stage III and Stage IV",
x = "Time in Years",
y = "MRL Difference (Years)",
color = "Comparison"
) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
theme_minimal()
# Plot: Stage II vs Stage III
ggplot(mrl_diff_2_3, aes(x = time, y = mrl_diff)) +
geom_line(color = "steelblue", size = 1.2) +
labs(
title = "Mean Residual Life Difference: Stage II vs Stage III",
x = "Time in Years",
y = "MRL Difference (Stage II - III)"
) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
theme_minimal()
# Plot: Stage II vs Stage IV
ggplot(mrl_diff_2_4, aes(x = time, y = mrl_diff)) +
geom_line(color = "firebrick", size = 1.2) +
labs(
title = "Mean Residual Life Difference: Stage II vs Stage IV",
x = "Time in Years",
y = "MRL Difference (Stage II - IV)"
) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
theme_minimal()
# Determine max time for shortest group in Stage II vs III
max_time_2_3 <- min(
max(mrl_2_3_stage2$time, na.rm = TRUE),
max(mrl_2_3_stage3$time, na.rm = TRUE)
)
# Plot with x-axis limited
ggplot(mrl_diff_2_3 %>% filter(time <= max_time_2_3), aes(x = time, y = mrl_diff)) +
geom_line(color = "steelblue", size = 1.2) +
labs(
title = "Mean Residual Life Difference: Stage II vs Stage III",
x = "Time in Years",
y = "MRL Difference (Stage II - III)"
) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
xlim(0, max_time_2_3) +
theme_minimal()
# Determine max time for shortest group in Stage II vs IV
max_time_2_4 <- min(
max(mrl_2_4_stage2$time, na.rm = TRUE),
max(mrl_2_4_stage4$time, na.rm = TRUE)
)
# Plot with x-axis limited
ggplot(mrl_diff_2_4 %>% filter(time <= max_time_2_4), aes(x = time, y = mrl_diff)) +
geom_line(color = "firebrick", size = 1.2) +
labs(
title = "Mean Residual Life Difference: Stage II vs Stage IV",
x = "Time in Years",
y = "MRL Difference (Stage II - IV)"
) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
xlim(0, max_time_2_4) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
# Required libraries
library(survival)
library(survminer)
library(ggplot2)
library(tidyverse)
surv_brca_cli<- read.csv("surv_brca_cli.csv")
surv_object <- Surv(time = surv_brca_cli$time_in_years, event = surv_brca_cli$vital_status)
head(surv_brca_cli)
surv_brca_cli= surv_brca_cli %>% mutate(group= pathologic_stage) %>% mutate( group= case_when( group=="Stage I"~ "Group A",group=="Stage II"~ "Group B",group=="Stage III"~ "Group C",group=="Stage IV"~ "Group D",group=="Stage X"~ "Group E",group=="Unspecified"~ "Group F"))
summary(surv_brca_cli$pathologic_stage)
group2_3_df<- surv_brca_cli|> select(time_in_years,vital_status,group)|> filter(group == "Group B" | group == "Group C")
fit23 <- survfit(Surv(time_in_years,vital_status)~group, data = group2_3_df)
KM_23=ggsurvplot(
fit23,
conf.int = FALSE,
risk.table = FALSE,
xlab = "Time in years",
ylab = "Survival Probability",
ggtheme = theme_minimal(),
pval = FALSE,
title= "Kaplan Meier plot for Group A and B ",
legend.labs = c("Group A", "Group B")
)
KM_23
ggsave("KM_23.png", plot = KM_23, width = 8, height = 6, dpi = 300,bg="white")
knitr::opts_chunk$set(echo = TRUE)
# Required libraries
library(survival)
library(survminer)
library(ggplot2)
library(tidyverse)
surv_brca_cli<- read.csv("surv_brca_cli.csv")
surv_object <- Surv(time = surv_brca_cli$time_in_years, event = surv_brca_cli$vital_status)
head(surv_brca_cli)
surv_brca_cli= surv_brca_cli %>% mutate(group= pathologic_stage) %>% mutate( group= case_when( group=="Stage I"~ "Group A",group=="Stage II"~ "Group B",group=="Stage III"~ "Group C",group=="Stage IV"~ "Group D",group=="Stage X"~ "Group E",group=="Unspecified"~ "Group F"))
summary(surv_brca_cli$pathologic_stage)
#fit the kaplan meier model for pathologic stage
fit_path_stage <- survfit(surv_object ~ group , data = surv_brca_cli)
ggsurvplot(
fit_path_stage,
size = 1.5,                  # Line thickness
font.x = c(16, "bold"),      # Font size for X-axis
font.y = c(16, "bold"),      # Font size for Y-axis
font.tickslab = c(10),       # Font size for tick labels
legend = "right",
conf.int = TRUE,
risk.table = TRUE,
pval = TRUE,
xlab = "Time(years)",
ylab = "Survival Probability",
ggtheme = theme_minimal(),
legend.title = "pathological stage",
risk.table.height = 0.5,
surv.median.line = "hv" ,
legend.labs = c("Group A", "Group B","Group C","Group D","Group E","Group F")
)
group2_3_df<- surv_brca_cli|> select(time_in_years,vital_status,group)|> filter(group == "Group B" | group == "Group C")
fit23 <- survfit(Surv(time_in_years,vital_status)~group, data = group2_3_df)
KM_23=ggsurvplot(
fit23,
conf.int = FALSE,
risk.table = FALSE,
xlab = "Time in years",
ylab = "Survival Probability",
ggtheme = theme_minimal(),
pval = FALSE,
title= "Kaplan Meier plot for Group A and B ",
legend.labs = c("Group A", "Group B")
)
KM_23
ggsave("KM_23.png", plot = KM_23, width = 8, height = 6, dpi = 300,bg="white")
ggsave("KM_23.png", plot = KM_23$plot, width = 8, height = 6, dpi = 300,bg="white")
#KM fit of the data
km_fit_groupb <- survfit(Surv(time= time_in_years, event=vital_status) ~ 1, data = subset(surv_brca_cli, group == "Group B"))
km_fit_groupc <- survfit(Surv(time= time_in_years, event=vital_status) ~ 1, data = subset(surv_brca_cli, group == "Group C"))
####extract survival probabilities
# Manually define time points (we mentained the exact time in the data set in days )
manual_times <- seq(0, max(surv_brca_cli$time_in_years, na.rm = TRUE), by = 0.08333)
# Extract survival probabilities for Pathologic stage 2
surv_groupb <- summary(km_fit_groupb, times = manual_times, extend = TRUE)$surv
# Extract survival probabilities for pathologic stage 3
surv_groupc <- summary(km_fit_groupc, times = manual_times, extend = TRUE)$surv
# Survival ratios and confidence intervals
survival_ratio <- surv_groupb / surv_groupc
# Confidence intervals using the Delta method
# Extract Variances  forgroup B and C
var_groupb <- (summary(km_fit_groupb, times = manual_times, extend = TRUE)$std.err)^2
var_groupc <- (summary(km_fit_groupc, times = manual_times, extend = TRUE)$std.err)^2
# Log-transformed survival ratio
log_ratio <- log(survival_ratio)
# Variance of the log survival ratio
log_ratio_var <- var_pathIII / (surv_pathIII^2) + var_pathII / (surv_pathII^2)
ggplot(plot_data, aes(x = time)) +
# Survival ratio line
geom_line(aes(y = ratio, color = "Survival Ratio"), size = 1.2) +
# Confidence interval ribbon
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = "95% Confidence Interval"), alpha = 0.3) +
# Reference line
geom_hline(aes(yintercept = 1, linetype = "No Difference Line"), color = "red", size = 1 ) +
# Custom scales for the legend
scale_color_manual(
name = "Line",
values = c("Survival Ratio" = "green")
) +
scale_fill_manual(
name = "Confidence Bands",
values = c(
"95% Confidence Interval" = "blue"
)
) +
scale_linetype_manual(
name = "Reference",
values = c("No Difference Line" = "dashed")
) +
# Labels and theme
labs(
title = "Survival Ratio plot for Path. stage II/ III ",
x = "Time (years)",
y = "Survival Ratio (Pathologic Stage II / Stage III)"
) +
theme_minimal() +
theme(
legend.position = "right",  # Position of the legend
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
plot.title = element_text(face = "bold", size = 18)
)+
annotate("text", x = max(plot_data$Time) * 0.3, y = 2, label = "Higher survival for Pathologic stage 2", hjust = 0) +
annotate("text", x = max(plot_data$Time) * 0.3, y = 0.5, label = "Higher survival for pathologic stage 3", hjust = 0)
# Compute survival difference
survival_diff_groupbc <- surv_groupb - surv_groupc
# Compute standard error for difference
diff_var_groupbc <- var_groupb + var_groupc
z_value <- qnorm(0.975)
lower_ci_groupbc_dif <- survival_diff_groupbc - z_value * sqrt(diff_var_groupbc)
upper_ci_groupbc_dif<- survival_diff_groupbc + z_value * sqrt(diff_var_groupbc)
# Prepare data for plotting
plot_data_diffbc <- data.frame(
time = manual_times,
difference = survival_diff_groupbc,
lower_ci = lower_ci_groupbc_dif,
upper_ci = upper_ci_groupbc_dif)
# Generate survival difference plot
ggplot(plot_data_diffbc, aes(x = time)) +
geom_line(aes(y = difference, color = "Survival Difference"), size = 1.2) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = "95% Confidence Interval"), alpha = 0.3) +
geom_hline(aes(yintercept = 0, linetype = "No Difference Line"), color = "red", size = 1) +
scale_color_manual(name = "Line", values = c("Survival Difference" = "green")) +
scale_fill_manual(name = "Confidence Bands", values = c("95% Confidence Interval" = "blue")) +
scale_linetype_manual(name = "Reference", values = c("No Difference Line" = "dashed")) +
labs(
title = "Survival difference plot for group A and B",
x = "Time (Years)",
y = "Survival Difference (Group A - Group B)"
) +
theme_minimal() +
theme(
legend.position = "right",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
plot.title = element_text(face = "bold", size = 18)
)
# Generate survival difference plot
KM_diff_23 <- ggplot(plot_data_diffbc, aes(x = time)) +
geom_line(aes(y = difference, color = "Survival Difference"), size = 1.2) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = "95% Confidence Interval"), alpha = 0.3) +
geom_hline(aes(yintercept = 0, linetype = "No Difference Line"), color = "red", size = 1) +
scale_color_manual(name = "Line", values = c("Survival Difference" = "green")) +
scale_fill_manual(name = "Confidence Bands", values = c("95% Confidence Interval" = "blue")) +
scale_linetype_manual(name = "Reference", values = c("No Difference Line" = "dashed")) +
labs(
title = "Survival difference plot for group A and B",
x = "Time (Years)",
y = "Survival Difference (Group A - Group B)"
) +
theme_minimal() +
theme(
legend.position = "right",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
plot.title = element_text(face = "bold", size = 18)
)
ggsave("KM_diff_23.png", plot = KM_diff_23$plot, width = 8, height = 6, dpi = 300,bg="white")
KM_diff_23 <- ggplot(plot_data_diffbc, aes(x = time)) +
geom_line(aes(y = difference, color = "Survival Difference"), size = 1.2) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = "95% Confidence Interval"), alpha = 0.3) +
geom_hline(aes(yintercept = 0, linetype = "No Difference Line"), color = "red", size = 1) +
scale_color_manual(name = "Line", values = c("Survival Difference" = "green")) +
scale_fill_manual(name = "Confidence Bands", values = c("95% Confidence Interval" = "blue")) +
scale_linetype_manual(name = "Reference", values = c("No Difference Line" = "dashed")) +
labs(
title = "Survival difference plot for group A and B",
x = "Time (Years)",
y = "Survival Difference (Group A - Group B)"
) +
theme_minimal() +
theme(
legend.position = "right",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
plot.title = element_text(face = "bold", size = 18)
)
KM_diff_23
ggsave("KM_diff_23.png", plot = KM_diff_23, width = 8, height = 6, dpi = 300,bg="white")
group2_4_df<- surv_brca_cli|> select(time_in_years,vital_status,group)|> filter(group == "Group B" | group == "Group D")
fit24 <- survfit(Surv(time_in_years,vital_status)~group, data = group2_4_df)
ggsurvplot(
fit24,
conf.int = FALSE,
risk.table = FALSE,
xlab = "Time in years",
ylab = "Survival Probability",
ggtheme = theme_minimal(),
pval = FALSE,
title= "Kaplan Meier plot for group A and B",
legend.labs = c("Group A", "Group B")
)
group2_4_df<- surv_brca_cli|> select(time_in_years,vital_status,group)|> filter(group == "Group B" | group == "Group D")
fit24 <- survfit(Surv(time_in_years,vital_status)~group, data = group2_4_df)
KM_24 <- ggsurvplot(
fit24,
conf.int = FALSE,
risk.table = FALSE,
xlab = "Time in years",
ylab = "Survival Probability",
ggtheme = theme_minimal(),
pval = FALSE,
title= "Kaplan Meier plot for group A and C",
legend.labs = c("Group A", "Group C")
)
ggsave("KM_24.png", plot = KM_24$plot, width = 8, height = 6, dpi = 300,bg="white")
data_group4 = subset(surv_brca_cli, group == "Group D")
#KM fit of the data
km_fit_groupb <- survfit(Surv(time= time_in_years, event=vital_status) ~ 1, data = subset(surv_brca_cli, group == "Group B"))
km_fit_groupd <- survfit(Surv(time= time_in_years, event=vital_status) ~ 1, data = subset(surv_brca_cli, group == "Group D"))
####extract survival probabilities
# Manually define time points (we mentained the exact time in the data set in days )
manual_times <- seq(0, max(data_group4$time_in_years, na.rm = TRUE), by = 0.08333)
# Extract survival probabilities for Pathologic stage 2
surv_groupb <- summary(km_fit_groupb, times = manual_times, extend = TRUE)$surv
# Extract survival probabilities for pathologic stage 3
surv_groupd <- summary(km_fit_groupd, times = manual_times, extend = TRUE)$surv
# Survival ratios and confidence intervals
#survival_ratio <- surv_groupb / surv_groupc
# Confidence intervals using the Delta method
# Extract Variances  forgroup B and D
var_groupb <- (summary(km_fit_groupb, times = manual_times, extend = TRUE)$std.err)^2
var_groupd <- (summary(km_fit_groupd, times = manual_times, extend = TRUE)$std.err)^2
# Log-transformed survival ratio
log_ratio_stage2_4 <- log(survival_ratio_stage2_4)
# Compute survival difference
survival_diff_groupbd <- surv_groupb - surv_groupd
# Compute standard error for difference
diff_var_groupbd <- var_groupb + var_groupd
z_value <- qnorm(0.975)
lower_ci_groupbd_dif <- survival_diff_groupbd - z_value * sqrt(diff_var_groupbd)
upper_ci_groupbd_dif<- survival_diff_groupbd + z_value * sqrt(diff_var_groupbd)
# Prepare data for plotting
plot_data_diffbd <- data.frame(
time = manual_times,
difference = survival_diff_groupbd,
lower_ci = lower_ci_groupbd_dif,
upper_ci = upper_ci_groupbd_dif)
# Generate survival difference plot
ggplot(plot_data_diffbd, aes(x = time)) +
geom_line(aes(y = difference, color = "Survival Difference"), size = 1.2) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = "95% Confidence Interval"), alpha = 0.3) +
geom_hline(aes(yintercept = 0, linetype = "No Difference Line"), color = "red", size = 1) +
scale_color_manual(name = "Line", values = c("Survival Difference" = "green")) +
scale_fill_manual(name = "Confidence Bands", values = c("95% Confidence Interval" = "blue")) +
scale_linetype_manual(name = "Reference", values = c("No Difference Line" = "dashed")) +
labs(
title = "Survival difference plot for group A and B",
x = "Time (Years)",
y = "Survival Difference (Group A - Group B)"
) +
theme_minimal() +
theme(
legend.position = "right",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
plot.title = element_text(face = "bold", size = 18)
)
# Compute survival difference
survival_diff_groupbd <- surv_groupb - surv_groupd
# Compute standard error for difference
diff_var_groupbd <- var_groupb + var_groupd
z_value <- qnorm(0.975)
lower_ci_groupbd_dif <- survival_diff_groupbd - z_value * sqrt(diff_var_groupbd)
upper_ci_groupbd_dif<- survival_diff_groupbd + z_value * sqrt(diff_var_groupbd)
# Prepare data for plotting
plot_data_diffbd <- data.frame(
time = manual_times,
difference = survival_diff_groupbd,
lower_ci = lower_ci_groupbd_dif,
upper_ci = upper_ci_groupbd_dif)
# Generate survival difference plot
KM_diff_24 <- ggplot(plot_data_diffbd, aes(x = time)) +
geom_line(aes(y = difference, color = "Survival Difference"), size = 1.2) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = "95% Confidence Interval"), alpha = 0.3) +
geom_hline(aes(yintercept = 0, linetype = "No Difference Line"), color = "red", size = 1) +
scale_color_manual(name = "Line", values = c("Survival Difference" = "green")) +
scale_fill_manual(name = "Confidence Bands", values = c("95% Confidence Interval" = "blue")) +
scale_linetype_manual(name = "Reference", values = c("No Difference Line" = "dashed")) +
labs(
title = "Survival difference plot for group A and B",
x = "Time (Years)",
y = "Survival Difference (Group A - Group B)"
) +
theme_minimal() +
theme(
legend.position = "right",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
plot.title = element_text(face = "bold", size = 18)
)
ggsave("KM_diff_24.png", plot = KM_diff_24, width = 8, height = 6, dpi = 300,bg="white")
# Compute survival difference
survival_diff_groupbd <- surv_groupb - surv_groupd
# Compute standard error for difference
diff_var_groupbd <- var_groupb + var_groupd
z_value <- qnorm(0.975)
lower_ci_groupbd_dif <- survival_diff_groupbd - z_value * sqrt(diff_var_groupbd)
upper_ci_groupbd_dif<- survival_diff_groupbd + z_value * sqrt(diff_var_groupbd)
# Prepare data for plotting
plot_data_diffbd <- data.frame(
time = manual_times,
difference = survival_diff_groupbd,
lower_ci = lower_ci_groupbd_dif,
upper_ci = upper_ci_groupbd_dif)
# Generate survival difference plot
KM_diff_24 <- ggplot(plot_data_diffbd, aes(x = time)) +
geom_line(aes(y = difference, color = "Survival Difference"), size = 1.2) +
geom_ribbon(aes(ymin = lower_ci, ymax = upper_ci, fill = "95% Confidence Interval"), alpha = 0.3) +
geom_hline(aes(yintercept = 0, linetype = "No Difference Line"), color = "red", size = 1) +
scale_color_manual(name = "Line", values = c("Survival Difference" = "green")) +
scale_fill_manual(name = "Confidence Bands", values = c("95% Confidence Interval" = "blue")) +
scale_linetype_manual(name = "Reference", values = c("No Difference Line" = "dashed")) +
labs(
title = "Survival difference plot for group A and C",
x = "Time (Years)",
y = "Survival Difference (Group A - Group C)"
) +
theme_minimal() +
theme(
legend.position = "right",
legend.title = element_text(size = 12),
legend.text = element_text(size = 10),
plot.title = element_text(face = "bold", size = 18)
)
ggsave("KM_diff_24.png", plot = KM_diff_24, width = 8, height = 6, dpi = 300,bg="white")
